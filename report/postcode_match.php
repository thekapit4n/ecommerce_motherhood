<?php
/** Include PHPExcel */
require_once dirname(__FILE__) . '/../tools/PHPExcel-1.8/Classes/PHPExcel.php';
require_once dirname(__FILE__) . '/../admin2635/dashboard/events/events_db_config_excel.php';

	$arr_postcode = array(
		"81100",
		"32900",
		"81800",
		"85200",
		"86200",
		"36400",
		"57000",
		"41200",
		"41200",
		"26600",
		"11900",
		"12200",
		"43900",
		"42300",
		"81700",
		"17000",
		"31350",
		"42300",
		"81300",
		"26500",
		"59200",
		"43900",
		"45000",
		"22300",
		"16310",
		"43300",
		"17000",
		"47120",
		"42160",
		"42100",
		"42100",
		"43300",
		"71800",
		"40400",
		"43000",
		"72000",
		"43500",
		"85300",
		"48050",
		"56100",
		"47130",
		"84400",
		"73000",
		"41300",
		"15050",
		"72100",
		"41050",
		"05400",
		"51000",
		"26060",
		"25150",
		"13400",
		"40300",
		"24000",
		"75100",
		"43000",
		"14000",
		"21300",
		"50000",
		"89208",
		"89050",
		"21600",
		"26700",
		"54200",
		"75050",
		"52100",
		"08000",
		"08000",
		"41200",
		"42200",
		"81200",
		"47000",
		"81300",
		"78000",
		"41200",
		"09400",
		"81750",
		"53100",
		"81100",
		"43300",
		"16150",
		"42300",
		"47810",
		"83500",
		"83000",
		"57000",
		"43000",
		"50480",
		"43300",
		"68100",
		"31200",
		"16400",
		"85010",
		"26600",
		"68100",
		"55000",
		"85200",
		"43000",
		"58000",
		"83000",
		"81750",
		"51000",
		"77300",
		"57100",
		"43000",
		"41300",
		"68000",
		"71700",
		"41100",
		"41200",
		"06300",
		"28050",
		"24000",
		"26100",
		"13500",
		"81750",
		"21800",
		"41200",
		"21450",
		"43500",
		"56100",
		"58200",
		"31150",
		"31150",
		"56100",
		"21100",
		"43500",
		"93582",
		"96600",
		"51200",
		"14000",
		"71800",
		"83610",
		"84000",
		"70450",
		"75200",
		"10150",
		"22200",
		"24000",
		"28000",
		"13200",
		"31800",
		"41200",
		"81750",
		"14100",
		"41200",
		"43200",
		"52200",
		"73420",
		"43650",
		"47180",
		"43000",
		"81200",
		"81750",
		"47180",
		"06200",
		"16450",
		"81400",
		"15050",
		"75250",
		"86800",
		"24000",
		"06600",
		"41050",
		"11920",
		"80350",
		"44100",
		"28700",
		"88460",
		"47301",
		"46000",
		"81750",
		"13050",
		"28000",
		"81100",
		"40400",
		"48050",
		"09100",
		"16100",
		"43300",
		"46000",
		"53300",
		"32040",
		"77300",
		"75100",
		"47180",
		"52100",
		"70450",
		"55000",
		"94600",
		"06400",
		"40150",
		"53300",
		"47810",
		"40200",
		"28000",
		"43100",
		"59200",
		"81200",
		"47100",
		"68100",
		"17600",
		"24000",
		"30250",
		"26080",
		"43200",
		"16150",
		"13100",
		"42610",
		"42610",
		"43200",
		"98000",
		"14000",
		"11600",
		"43500",
		"84900",
		"11960",
		"21400",
		"96400",
		"83000",
		"25200",
		"81900",
		"40400",
		"36000",
		"43800",
		"47400",
		"79100",
		"16040",
		"18500",
		"68000",
		"08000",
		"81100",
		"25100",
		"16400",
		"40170",
		"96800",
		"36800",
		"43500",
		"70400",
		"43200",
		"15400",
		"17010",
		"81300",
		"26100",
		"68000",
		"16310",
		"16250",
		"58200",
		"43300",
		"96150",
		"94000",
		"08600",
		"09000",
		"47120",
		"47600",
		"75150",
		"22120",
		"68100",
		"71750",
		"80150",
		"53300",
		"24050",
		"81300",
		"96000",
		"02600",
		"15050",
		"42000",
		"78000",
		"54200",
		"47200",
		"93050",
		"10300",
		"81800",
		"43650",
		"25150",
		"75350",
		"05150",
		"81700",
		"51200",
		"81100",
		"11400",
		"41200",
		"33020",
		"42100",
		"81100",
		"56100",
		"83000",
		"13500",
		"98000",
		"72120",
		"16370",
		"57000",
		"81100",
		"31600",
		"14300",
		"25200",
		"81100",
		"43000",
		"70300",
		"88200",
		"47130",
		"47400",
		"10460",
		"81700",
		"42300",
		"89800",
		"34600",
		"13310",
		"14200",
		"07000",
		"56100",
		"96100",
		"43000",
		"21600",
		"31200",
		"21600",
		"84000",
		"13210",
		"11900",
		"57000",
		"28200",
		"88450",
		"81300",
		"84300",
		"71700",
		"41000",
		"55300",
		"43300",
		"23000",
		"48050",
		"47830",
		"09000",
		"08000",
		"23100",
		"47410",
		"51200",
		"42200",
		"08300",
		"96000",
		"84000",
		"42610",
		"56100",
		"16100",
		"86000",
		"81100",
		"27000",
		"81100",
		"06650",
		"54200",
		"84400",
		"22010",
		"81100",
		"43800",
		"43100",
		"26900",
		"26600",
		"47120",
		"52200",
		"43200",
		"81100",
		"21300",
		"89208",
		"81300",
		"43000",
		"43000",
		"08000",
		"13400",
		"34200",
		"42700",
		"73000",
		"11900",
		"42700",
		"11500",
		"18500",
		"41050",
		"81000",
		"46100",
		"41200",
		"43300",
		"25990",
		"25300",
		"81200",
		"45600",
		"40170",
		"98000",
		"26800",
		"08000",
		"81900",
		"52200",
		"01000",
		"85300",
		"26060",
		"81300",
		"75450",
		"81400",
		"40150",
		"43000",
		"42920",
		"14400",
		"47000",
		"14300",
		"81000",
		"43000",
		"81200",
		"08400",
		"35000",
		"41259",
		"16200",
		"10150",
		"14000",
		"81800",
		"81100",
		"27100",
		"43300",
		"43300",
		"33300",
		"89908",
		"70300",
		"47100",
		"06100",
		"47600",
		"26610",
		"81100",
		"98000",
		"42200",
		"75460",
		"11000",
		"47500",
		"32600",
		"32400",
		"28200",
		"31400",
		"24000",
		"26080",
		"83000",
		"47100",
		"09200",
		"33300",
		"11910",
		"78000",
		"43300",
		"81800",
		"17000",
		"71950",
		"93150",
		"90200",
		"79250",
		"02500",
		"26700",
		"23100",
		"40150",
		"16150",
		"68100",
		"77300",
		"25150",
		"31560",
		"59200",
		"11600",
		"32040",
		"25200",
		"46000",
		"76100",
		"56000",
		"34250",
		"40300",
		"40460",
		"43300",
		"48300",
		"93050",
		"34900",
		"30450",
		"53200",
		"46150",
		"86000",
		"84000",
		"25150",
		"44300",
		"52100",
		"11700",
		"86000",
		"32600",
		"16100",
		"30100",
		"46100",
		"14300",
		"57100",
		"47100",
		"70300",
		"86000",
		"43000",
		"26070",
		"40200",
		"81930",
		"46050",
		"30100",
		"54200",
		"43200",
		"41200",
		"73000",
		"14000",
		"53300",
		"85000",
		"41050",
		"26070",
		"08000",
		"25150",
		"43200",
		"21400",
		"71250",
		"40150",
		"68000",
		"13310",
		"52100",
		"80350",
		"34800",
		"84410",
		"42500",
		"43300",
		"43000",
		"47000",
		"41050",
		"51200",
		"72100",
		"43500",
		"50300",
		"68000",
		"71800",
		"17510",
		"81200",
		"14000",
		"47830",
		"41200",
		"32040",
		"56100",
		"45300",
		"45000",
		"42600",
		"43000",
		"14300",
		"01000",
		"86000",
		"68000",
		"34800",
		"34600",
		"26800",
		"68100",
		"41050",
		"08000",
		"59200",
		"52100",
		"43300",
		"16100",
		"72200",
		"43500",
		"91308",
		"06000",
		"68100",
		"83100",
		"40460",
		"53300",
		"16150",
		"06900",
		"31650",
		"43300",
		"31350",
		"81100",
		"36700",
		"78000",
		"40170",
		"43200",
		"42600",
		"21400",
		"13020",
		"51200",
		"26700",
		"84000",
		"10460",
		"16200",
		"42700",
		"46200",
		"16090",
		"68100",
		"14000",
		"75250",
		"42600",
		"42700",
		"34000",
		"31200",
		"47100",
		"41200",
		"84000",
		"81400",
		"41050",
		"40170",
		"42600",
		"43300",
		"62250",
		"56000",
		"47400",
		"16400",
		"42700",
		"57100",
		"76400",
		"77300",
		"06000",
		"93300",
		"21600",
		"68100",
		"14100",
		"16040",
		"43800",
		"25100",
		"40000",
		"73400",
		"31750",
		"42700",
		"56100",
		"48020",
		"51100",
		"46000",
		"47100",
		"43800",
		"68000",
		"25200",
		"43300",
		"76300",
		"43200",
		"81700",
		"11900",
		"11600",
		"21200",
		"47120",
		"77200",
		"83600",
		"98000",
		"30100",
		"90000",
		"81100",
		"48300",
		"16200",
		"31200",
		"46150",
		"79100",
		"81100",
		"31450",
		"27500",
		"81200",
		"20050",
		"43500",
		"55300",
		"40170",
		"40150",
		"31600",
		"41200",
		"59100",
		"31650",
		"10460",
		"13500",
		"78000",
		"32000",
		"80150",
		"11900",
		"40150",
		"43000",
		"53200",
		"81000",
		"43200",
		"47830",
		"81750",
		"40170",
		"86400",
		"31400",
		"94300",
		"68100",
		"13400",
		"11900",
		"16150",
		"43800",
		"97000",
		"54200",
		"85000",
		"21100",
		"89600",
		"81800",
		"14300",
		"48000",
		"57000",
		"46200",
		"81900",
		"43500",
		"17500",
		"47180",
		"81100"
	);
	
	$table 	= "";
	$table .= "<table class='table-bordered table-sm' style='border: 1px solid black;border-collapse: collapse;'>";
	foreach($arr_postcode as $valPostcode)
	{
		$sql = "SELECT a.postcode, a.post_office, b.state_name FROM motherhood_presta.ps_postcode a
				LEFT JOIN ps_postcode_state b 
				ON a.state_code = b.state_code
				WHERE a.postcode = " . trim($valPostcode) . " LIMIT 1";
				
		$result = $conn->query($sql);
		if(is_object($result))
		{
			$row = mysqli_fetch_row($result);
			if(sizeof($row) == 3)
			{
				$statename = $row[2];
				if(strtolower($statename) == 'wilayah persekutuan kuala lumpur')
				{
					$statename = "Kuala Lumpur";
				}
				elseif(strtolower($statename) == 'wilayah persekutuan labuan')
				{
					$statename = "Labuan";
				}
				elseif(strtolower($statename) == 'wilayah persekutuan putrajaya')
				{
					$statename = "Putrajaya";
				}
				
			
				$table .= "<tr><td style='border: 1px solid black;'>" . $row[0] . "</td><td style='border: 1px solid black;'>" . $row[1] . "</td><td style='border: 1px solid black;'>" . $statename . "</td></tr>";
			}
			else
			{
				$table .= "<tr><td style='border: 1px solid black;'>" . $valPostcode . "</td><td style='border: 1px solid black;'>Postcode not detected</td></tr>";
			}	
		}
	}
	$table .= "</table>";
	
	echo $table;
	
	exit("sds");
	
	
?>
